<!DOCTYPE html>
<html>
	<head>
		<title>floppy</title>
        <link type="text/css" rel="stylesheet" href="stylesheet.css" />
	</head>
	<body>
        <div id="canvas-container">
            <canvas id="canvas">Your browser doesn't support HTML5</canvas>
        </div>
		<script>
            var canvas = document.getElementById("canvas"),
                ctx = canvas.getContext("2d"),
                width = 1200,                                //canvas dimensions
                height = 600,
                player = {                                   //player object
                    x: width/2, 
                    y: height/2,                             //starting point, middle of canvas
                    width: 20,
                    height: 20,                              //canvas dimensions must be divisible player dimensions
                    move: 20
                },
                ball = {
                    x: 200,
                    y: 200,
                    width: 20,
                    height: 20
                },
                boxes = [],                                  //border/boundaries/obstacles
                upCheck = false,
                downCheck = false,
                rightCheck = false,
                leftCheck = false,
                upBall = false,
                downBall = false,
                rightBall = false,
                leftBall = false,
                upBlock = false,
                downBlock = false,
                rightBlock = false,
                leftBlock = false;
                
            canvas.width = width;                            //applies dimensions to canvas
            canvas.height = height;
            
            function pad(number, digits) {
                return Array(Math.max(digits - String(number).length + 1, 0)).join(0) + number;
            }
            
            function createTimer(seconds) {
                intervalVar = setInterval(function () {
                    ctx.clearRect(970, 15, 200, 70);
                    ctx.font = "60px monospace";
                    ctx.fillStyle = "white";
                    ctx.textAlign = "center";
                    ctx.textBaseline = "middle";
                    var secondsToShow = (seconds).toString();
                   
                    ctx.fillText(pad(secondsToShow, 5), 1070, 50);
                    seconds++;
                }, 1000);
            }
            
            function drawBorder() {
                for (var i = 0; i < width / 20; i++) {       //border row, under header
                    boxes.push({
                        x: i * 20,
                        y: 80,
                    });
                }
                for (var i = 0; i < width/ 20; i++) {        //footer
                    boxes.push({
                        x: i * 20,
                        y: height - 20,
                    });
                }
                ctx.fillStyle = "#E05858";
                ctx.fillRect(0, 0, width, 80);               //draw header
                for (var i = 0; i < boxes.length; i++) {     //draw under header and footer
                    ctx.fillRect(boxes[i].x, boxes[i].y, 20, 20)
                }
            }
            
            function collisionCheck() {                      //check for collision
                for (var i = 0; i < boxes.length; i++) {
                    if (boxes[i].y == player.y - 20 && boxes[i].x == player.x) {
                        upCheck = true;
                        break;
                    }
                    else {
                        upCheck = false;
                    }
                }
                for (var i = 0; i < boxes.length; i++) {
                    if (boxes[i].y == player.y + 20 && boxes[i].x == player.x) {
                        downCheck = true;
                        break;
                    }
                    else {
                        downCheck = false;
                    }
                }
                for (var i = 0; i < boxes.length; i++) {
                    if (boxes[i].y == player.y && boxes[i].x == player.x + 20) {
                        rightCheck = true;
                        break;
                    }
                    else {
                        rightCheck = false;
                    }
                }
                for (var i = 0; i < boxes.length; i++) {
                    if (boxes[i].y == player.y && boxes[i].x == player.x - 20) {
                        leftCheck = true;
                        break;
                    }
                    else {
                        leftCheck = false;
                    }
                }
                if (ball.y == player.y - 20 && ball.x == player.x) {
                    upBall = true;
                    for (var i = 0; i < boxes.length; i++) {
                        if (boxes[i].y == ball.y - 20 && boxes[i].x == ball.x) {
                            upBlock = true;
                            break;
                        }
                        else {
                            upBlock = false;
                        }
                    }
                }
                else {
                    upBall = false;
                }
                if (ball.y == player.y + 20 && ball.x == player.x) {
                    downBall = true;
                    for (var i = 0; i < boxes.length; i++) {
                        if (boxes[i].y == ball.y + 20 && boxes[i].x == ball.x) {
                            downBlock = true;
                            break;
                        }
                        else {
                            downBlock = false;
                        }
                    }
                }
                else {
                    downBall = false;
                }
                if (ball.y == player.y && ball.x == player.x + 20) {
                    rightBall = true;
                    for (var i = 0; i < boxes.length; i++) {
                        if (boxes[i].y == ball.y && boxes[i].x == ball.x + 20) {
                            rightBlock = true;
                            break;
                        }
                        else {
                            rightBlock = false;
                        }
                    }
                }
                else {
                    rightBall = false;
                }
                if (ball.y == player.y && ball.x == player.x - 20) {
                    leftBall = true;
                    for (var i = 0; i < boxes.length; i++) {
                        if (boxes[i].y == ball.y && boxes[i].x == ball.x - 20) {
                            leftBlock = true;
                            break;
                        }
                        else {
                            leftBlock = false;
                        }
                    }
                }
                else {
                    leftBall = false;
                }
            }

            function move(evt){                              //event (keyboard input)
                switch (evt.keyCode) {
                    case 38:                                 //Up arrow was pressed
                        if (player.y > 0 && upCheck == false){ 
                            if (upBall == true && upBlock == false) {
                                player.y -= player.move;
                                ball.y -= 20;
                            }
                            else if (upBall == false) {
                                player.y -= player.move;
                            }
                            collisionCheck();
                        }
                      break;
                    case 40:                                 //Down arrow was pressed
                        if (player.y + player.height < height && downCheck == false){ 
                            if (downBall == true && downBlock == false) {
                                player.y += player.move;
                                ball.y += 20;
                            }
                            else if (downBall == false) {
                                player.y += player.move;
                            }
                            collisionCheck();
                        }
                      break;
                    case 37:                                 //Left arrow was pressed
                        if (player.x > 0 && leftCheck == false){ 
                            if (leftBall == true && leftBlock == false) {
                                player.x -= player.move;
                                ball.x -= 20;
                            }
                            else if (leftBall == false) {
                                player.x -= player.move;
                            }
                            collisionCheck();
                      }
                      break;
                    case 39:                                 //Right arrow was pressed
                        if (player.x + player.width < width && rightCheck == false){ 
                            if (rightBall == true && rightBlock == false) {
                                player.x += player.move;
                                ball.x += 20;
                            }
                            else if (rightBall == false) {
                                player.x += player.move;
                            }
                            collisionCheck();
                      }
                      break;
                }
            }
           
            function init() {
                createTimer(0000);
                drawBorder();
                return setInterval(update, 10);              //run update() every 10ms
            }
            
            function update() {
                ctx.clearRect(0, 100, width, height - 120);          //clears canvas
                ctx.fillStyle = "white";                     //player style + draw player
                ctx.fillRect(player.x, player.y, player.width, player.height);
                ctx.fillStyle = "#3498DB";
                ctx.fillRect(ball.x, ball.y, ball.width, ball.height);
            }

            window.addEventListener('keydown', move, true);  //if key is pressed, execute move()
            
            window.addEventListener("load", function(){      //start init() upon page load
                init();
            });
		</script>
	</body>
</html>
